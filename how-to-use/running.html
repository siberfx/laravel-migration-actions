<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.54">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" href="https://actions.dragon-code.pro/images/logo.svg"><meta name="twitter:image" content="https://actions.dragon-code.pro/images/logo.svg"><title>Running Actions | Dragon Code: Actions</title><meta name="description" content="Performing actions with saving the list of called files">
    <link rel="preload" href="/assets/style.42589293.css" as="style" /><link rel="stylesheet" href="/assets/style.42589293.css" />
    <link rel="modulepreload" href="/assets/app.b5592433.js"><link rel="modulepreload" href="/assets/framework.2b954cae.js"><link rel="modulepreload" href="/assets/running.html.71cab568.js"><link rel="modulepreload" href="/assets/running.html.15266b68.js"><link rel="prefetch" href="/assets/index.html.45b7e1fc.js" as="script" /><link rel="prefetch" href="/assets/artisan.html.2ef79695.js" as="script" /><link rel="prefetch" href="/assets/events.html.bbb95fbf.js" as="script" /><link rel="prefetch" href="/assets/execution-status.html.96f53be9.js" as="script" /><link rel="prefetch" href="/assets/creating.html.f8837070.js" as="script" /><link rel="prefetch" href="/assets/customize-stub.html.a0a06e61.js" as="script" /><link rel="prefetch" href="/assets/rollback.html.cacbbfaa.js" as="script" /><link rel="prefetch" href="/assets/status.html.35b39944.js" as="script" /><link rel="prefetch" href="/assets/license.html.38d98e6d.js" as="script" /><link rel="prefetch" href="/assets/index.html.b4d20dea.js" as="script" /><link rel="prefetch" href="/assets/3.x.html.ec415d39.js" as="script" /><link rel="prefetch" href="/assets/4.x.html.e251fc74.js" as="script" /><link rel="prefetch" href="/assets/index.html.c29a6a1b.js" as="script" /><link rel="prefetch" href="/assets/3.x.html.a13bd2f6.js" as="script" /><link rel="prefetch" href="/assets/4.x.html.b27d8c81.js" as="script" /><link rel="prefetch" href="/assets/index.html.aec3cf91.js" as="script" /><link rel="prefetch" href="/assets/404.html.d2dc3323.js" as="script" /><link rel="prefetch" href="/assets/index.html.de5a0afa.js" as="script" /><link rel="prefetch" href="/assets/artisan.html.575c4435.js" as="script" /><link rel="prefetch" href="/assets/events.html.b5751d1a.js" as="script" /><link rel="prefetch" href="/assets/execution-status.html.c51001be.js" as="script" /><link rel="prefetch" href="/assets/creating.html.48d30b49.js" as="script" /><link rel="prefetch" href="/assets/customize-stub.html.5dcb48d9.js" as="script" /><link rel="prefetch" href="/assets/rollback.html.c12e57ec.js" as="script" /><link rel="prefetch" href="/assets/status.html.65983a9a.js" as="script" /><link rel="prefetch" href="/assets/license.html.cc83bd3a.js" as="script" /><link rel="prefetch" href="/assets/index.html.4b1ff2a3.js" as="script" /><link rel="prefetch" href="/assets/3.x.html.9cd88c36.js" as="script" /><link rel="prefetch" href="/assets/4.x.html.44b66d3c.js" as="script" /><link rel="prefetch" href="/assets/index.html.f01df33a.js" as="script" /><link rel="prefetch" href="/assets/3.x.html.a0262a89.js" as="script" /><link rel="prefetch" href="/assets/4.x.html.eebe9d63.js" as="script" /><link rel="prefetch" href="/assets/index.html.e985b4a1.js" as="script" /><link rel="prefetch" href="/assets/404.html.a86359f6.js" as="script" /><link rel="prefetch" href="/assets/clientConfigs.736df56f.js" as="script" />
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><img class="logo" src="https://actions.dragon-code.pro/images/logo.svg" alt="Dragon Code: Actions"><span class="site-name can-hide">Dragon Code: Actions</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/prologue/changelog/4.x.md" class="" aria-label="4.x"><!--[--><!--]--> 4.x <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/TheDragonCode/laravel-actions" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/prologue/changelog/4.x.md" class="" aria-label="4.x"><!--[--><!--]--> 4.x <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/TheDragonCode/laravel-actions" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading">Prologue <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/prologue/upgrade-guide/index.md" class="sidebar-item" aria-label="Upgrade Guide"><!--[--><!--]--> Upgrade Guide <!--[--><!--]--></a><!----></li><li><a href="/prologue/license.md" class="sidebar-item" aria-label="License"><!--[--><!--]--> License <!--[--><!--]--></a><!----></li><li><a href="/prologue/changelog/index.md" class="sidebar-item collapsible" aria-label="Changelog"><!--[--><!--]--> Changelog <!--[--><!--]--></a><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/prologue/changelog/4.x.html" class="sidebar-item" aria-label="4.x"><!--[--><!--]--> 4.x <!--[--><!--]--></a><!----></li><li><a href="/prologue/changelog/3.x.html" class="sidebar-item" aria-label="3.x"><!--[--><!--]--> 3.x <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading">Getting Started <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/getting-started/installation/index.md" class="sidebar-item" aria-label="Installation"><!--[--><!--]--> Installation <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading active">How To Use <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/how-to-use/creating.html" class="sidebar-item" aria-label="Creating Actions"><!--[--><!--]--> Creating Actions <!--[--><!--]--></a><!----></li><li><a href="/how-to-use/customize-stub.html" class="sidebar-item" aria-label="Customize Stub"><!--[--><!--]--> Customize Stub <!--[--><!--]--></a><!----></li><li><a href="/how-to-use/rollback.html" class="sidebar-item" aria-label="Rolling Back Actions"><!--[--><!--]--> Rolling Back Actions <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/how-to-use/running.html" class="router-link-active router-link-exact-active router-link-active sidebar-item active" aria-label="Running Actions"><!--[--><!--]--> Running Actions <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/how-to-use/running.html#isolating-action-execution" class="router-link-active router-link-exact-active sidebar-item" aria-label="Isolating Action Execution"><!--[--><!--]--> Isolating Action Execution <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/how-to-use/running.html#split-launch-option" class="router-link-active router-link-exact-active sidebar-item" aria-label="Split Launch Option"><!--[--><!--]--> Split Launch Option <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/how-to-use/running.html#forcing-actions-to-run-in-production" class="router-link-active router-link-exact-active sidebar-item" aria-label="Forcing Actions To Run In Production"><!--[--><!--]--> Forcing Actions To Run In Production <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/how-to-use/running.html#execution-every-time" class="router-link-active router-link-exact-active sidebar-item" aria-label="Execution Every Time"><!--[--><!--]--> Execution Every Time <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/how-to-use/running.html#execution-in-a-specific-environment" class="router-link-active router-link-exact-active sidebar-item" aria-label="Execution In A Specific Environment"><!--[--><!--]--> Execution In A Specific Environment <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/how-to-use/running.html#execution-excluding-certain-environments" class="router-link-active router-link-exact-active sidebar-item" aria-label="Execution Excluding Certain Environments"><!--[--><!--]--> Execution Excluding Certain Environments <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/how-to-use/running.html#database-transactions" class="router-link-active router-link-exact-active sidebar-item" aria-label="Database Transactions"><!--[--><!--]--> Database Transactions <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/how-to-use/running.html#asynchronous-call" class="router-link-active router-link-exact-active sidebar-item" aria-label="Asynchronous Call"><!--[--><!--]--> Asynchronous Call <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a href="/how-to-use/status.html" class="sidebar-item" aria-label="Actions Status"><!--[--><!--]--> Actions Status <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading">Helpers <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/helpers/artisan.html" class="sidebar-item" aria-label="Artisan Command"><!--[--><!--]--> Artisan Command <!--[--><!--]--></a><!----></li><li><a href="/helpers/events.html" class="sidebar-item" aria-label="Events"><!--[--><!--]--> Events <!--[--><!--]--></a><!----></li><li><a href="/helpers/execution-status.html" class="sidebar-item" aria-label="Execution Status"><!--[--><!--]--> Execution Status <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="running-actions" tabindex="-1"><a class="header-anchor" href="#running-actions" aria-hidden="true">#</a> Running Actions</h1><p>To run all of your outstanding actions, execute the <code>actions</code> artisan command:</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>php artisan actions
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Action call order is checked by filename without path:</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>2022_10_14_000001_test1      <span class="token comment"># 1</span>
2022_10_14_000004_test4      <span class="token comment"># 4</span>
bar/2022_10_14_000003_test3  <span class="token comment"># 3</span>
foo/2022_10_14_000002_test2  <span class="token comment"># 2</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>2022_10_14_000001_test1      <span class="token comment"># 1</span>
foo/2022_10_14_000002_test2  <span class="token comment"># 2</span>
bar/2022_10_14_000003_test3  <span class="token comment"># 3</span>
2022_10_14_000004_test4      <span class="token comment"># 4</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="isolating-action-execution" tabindex="-1"><a class="header-anchor" href="#isolating-action-execution" aria-hidden="true">#</a> Isolating Action Execution</h2><p>If you are deploying your application across multiple servers and running actions as part of your deployment process, you likely do not want two servers attempting to run the database at the same time. To avoid this, you may use the <code>isolated</code> option when invoking the <code>actions</code> command.</p><p>When the <code>isolated</code> option is provided, Laravel will acquire an atomic lock using your application&#39;s cache driver before attempting to run your actions. All other attempts to run the <code>actions</code> command while that lock is held will not execute; however, the command will still exit with a successful exit status code:</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>php artisan actions <span class="token parameter variable">--isolated</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="split-launch-option" tabindex="-1"><a class="header-anchor" href="#split-launch-option" aria-hidden="true">#</a> Split Launch Option</h2><p>Sometimes it becomes necessary to launch actions separately, for example, to notify about the successful deployment of a project.</p><p>There is a <code>before</code> option for this when calling actions:</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>php artisan actions <span class="token parameter variable">--before</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>When calling the <code>actions</code> command with the <code>before</code> parameter, the script will execute only those actions within which the value of the <code>before</code> parameter is <code>true</code>.</p><p>For backwards compatibility, the <code>before</code> parameter is set to <code>true</code> by default, but actions will only be executed if the option is explicitly passed.</p><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">DragonCode<span class="token punctuation">\</span>LaravelActions<span class="token punctuation">\</span>Action</span><span class="token punctuation">;</span>

<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token keyword">class</span> <span class="token class-name-definition class-name">extends</span> <span class="token class-name">Action</span>
<span class="token punctuation">{</span>
    <span class="token keyword">protected</span> <span class="token keyword type-declaration">bool</span> <span class="token variable">$before</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">void</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// some code</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>For example, you need to call actions when deploying an application. Some actions should be run after the actions are deployed, and others after the application is fully launched.</p><p>To run, you need to pass the <code>before</code> parameter. For example, when using <a href="https://github.com/deployphp/deployer" target="_blank" rel="noopener noreferrer"><code>deployer</code><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> it would look like this:</p><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token function">task</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;deploy&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
    <span class="token comment">// ...</span>
    <span class="token string single-quoted-string">&#39;artisan:migrate&#39;</span><span class="token punctuation">,</span>
    <span class="token string single-quoted-string">&#39;artisan:actions --before&#39;</span><span class="token punctuation">,</span> <span class="token comment">// here</span>
    <span class="token string single-quoted-string">&#39;deploy:publish&#39;</span><span class="token punctuation">,</span>
    <span class="token string single-quoted-string">&#39;php-fpm:reload&#39;</span><span class="token punctuation">,</span>
    <span class="token string single-quoted-string">&#39;artisan:queue:restart&#39;</span><span class="token punctuation">,</span>
    <span class="token string single-quoted-string">&#39;artisan:actions&#39;</span><span class="token punctuation">,</span> <span class="token comment">// here</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Thus, when <code>actions</code> is called, all actions whose <code>before</code> parameter is <code>true</code> will be executed, and after that, the remaining tasks will be executed.</p><blockquote><p>Note: If you call the <code>actions</code> command without the <code>before</code> parameter, then all tasks will be executed regardless of the value of the <code>$before</code> attribute inside the action class.</p></blockquote><h2 id="forcing-actions-to-run-in-production" tabindex="-1"><a class="header-anchor" href="#forcing-actions-to-run-in-production" aria-hidden="true">#</a> Forcing Actions To Run In Production</h2><blockquote><p>Some commands cannot be executed in production without confirmation. These include all commands except <code>actions:status</code> and <code>actions</code>.</p></blockquote><p>Some action operations are destructive, which means they may cause you to lose data. In order to protect you from running these commands against your production database, you will be prompted for confirmation before the commands are executed. To force the commands to run without a prompt, use the <code>--force</code> flag:</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>php artisan actions:install <span class="token parameter variable">--force</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="execution-every-time" tabindex="-1"><a class="header-anchor" href="#execution-every-time" aria-hidden="true">#</a> Execution Every Time</h2><p>In some cases, you need to call the code every time you deploy the application. For example, to call reindexing.</p><p>To do this, override the <code>$once</code> variable in the action file:</p><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">DragonCode<span class="token punctuation">\</span>LaravelActions<span class="token punctuation">\</span>Action</span><span class="token punctuation">;</span>

<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token keyword">class</span> <span class="token class-name-definition class-name">extends</span> <span class="token class-name">Action</span>
<span class="token punctuation">{</span>
    <span class="token keyword">protected</span> <span class="token keyword type-declaration">bool</span> <span class="token variable">$once</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">void</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// some code</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>If the value is <code>$once = false</code>, the <code>up</code> method will be called every time the <code>actions</code> command called.</p><p>In this case, information about it will not be written to the <code>actions</code> table and, therefore, the <code>down</code> method will not be called when the rollback command is called.</p><blockquote><p>Note</p><p>When using the <code>before</code> parameter to run command, it is recommended to override the value of the <code>$before</code> attribute to <code>false</code>, otherwise this action will be executed twice.</p></blockquote><h2 id="execution-in-a-specific-environment" tabindex="-1"><a class="header-anchor" href="#execution-in-a-specific-environment" aria-hidden="true">#</a> Execution In A Specific Environment</h2><p>In some cases, it becomes necessary to execute an action in a specific environment. For example <code>production</code>.</p><p>For this you can use the <code>$environment</code> parameter:</p><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">DragonCode<span class="token punctuation">\</span>LaravelActions<span class="token punctuation">\</span>Action</span><span class="token punctuation">;</span>

<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token keyword">class</span> <span class="token class-name-definition class-name">extends</span> <span class="token class-name">Action</span>
<span class="token punctuation">{</span>
    <span class="token keyword">protected</span> <span class="token keyword type-declaration">string</span><span class="token operator">|</span><span class="token keyword type-declaration">array</span><span class="token operator">|</span><span class="token keyword type-declaration">null</span> <span class="token variable">$environment</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&#39;production&#39;</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">void</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// some code</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>You can also specify multiple environment names:</p><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">DragonCode<span class="token punctuation">\</span>LaravelActions<span class="token punctuation">\</span>Action</span><span class="token punctuation">;</span>

<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token keyword">class</span> <span class="token class-name-definition class-name">extends</span> <span class="token class-name">Action</span>
<span class="token punctuation">{</span>
    <span class="token keyword">protected</span> <span class="token keyword type-declaration">string</span><span class="token operator">|</span><span class="token keyword type-declaration">array</span><span class="token operator">|</span><span class="token keyword type-declaration">null</span> <span class="token variable">$environment</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;testing&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;staging&#39;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">void</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// some code</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>By default, the action will run in all environments. The same will happen if you specify <code>null</code> or <code>[]</code> as the value.</p><h2 id="execution-excluding-certain-environments" tabindex="-1"><a class="header-anchor" href="#execution-excluding-certain-environments" aria-hidden="true">#</a> Execution Excluding Certain Environments</h2><p>In some cases, it becomes necessary to execute an action excluding certain environments. For example <code>production</code>.</p><p>For this you can use the <code>$except_environment</code> parameter:</p><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">DragonCode<span class="token punctuation">\</span>LaravelActions<span class="token punctuation">\</span>Action</span><span class="token punctuation">;</span>

<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token keyword">class</span> <span class="token class-name-definition class-name">extends</span> <span class="token class-name">Action</span>
<span class="token punctuation">{</span>
    <span class="token keyword">protected</span> <span class="token keyword type-declaration">string</span><span class="token operator">|</span><span class="token keyword type-declaration">array</span><span class="token operator">|</span><span class="token keyword type-declaration">null</span> <span class="token variable">$exceptEnvironment</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&#39;production&#39;</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">void</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// some code</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>You can also specify multiple environment names:</p><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">DragonCode<span class="token punctuation">\</span>LaravelActions<span class="token punctuation">\</span>Action</span><span class="token punctuation">;</span>

<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token keyword">class</span> <span class="token class-name-definition class-name">extends</span> <span class="token class-name">Action</span>
<span class="token punctuation">{</span>
    <span class="token keyword">protected</span> <span class="token keyword type-declaration">string</span><span class="token operator">|</span><span class="token keyword type-declaration">array</span><span class="token operator">|</span><span class="token keyword type-declaration">null</span> <span class="token variable">$exceptEnvironment</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;testing&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;staging&#39;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">void</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// some code</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>By default, no actions will be excluded. The same happens if you specify <code>null</code> or <code>[]</code> value.</p><h2 id="database-transactions" tabindex="-1"><a class="header-anchor" href="#database-transactions" aria-hidden="true">#</a> Database Transactions</h2><p>In some cases, it becomes necessary to undo previously performed actions in the database. For example, when code execution throws an error. To do this, the code must be wrapped in a transaction.</p><p>By setting the <code>$transactions = true</code> parameter, you will ensure that your code is wrapped in a transaction without having to manually call the <code>DB::transaction()</code> method. This will reduce the time it takes to create the action.</p><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">DragonCode<span class="token punctuation">\</span>LaravelActions<span class="token punctuation">\</span>Action</span><span class="token punctuation">;</span>

<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token keyword">class</span> <span class="token class-name-definition class-name">extends</span> <span class="token class-name">Action</span>
<span class="token punctuation">{</span>
    <span class="token keyword">protected</span> <span class="token keyword type-declaration">bool</span> <span class="token variable">$transactions</span> <span class="token operator">=</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>

    <span class="token keyword">protected</span> <span class="token keyword type-declaration">int</span> <span class="token variable">$transactionAttempts</span> <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">void</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// some code</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="asynchronous-call" tabindex="-1"><a class="header-anchor" href="#asynchronous-call" aria-hidden="true">#</a> Asynchronous Call</h2><p>In some cases, it becomes necessary to execute actions in an asynchronous manner without delaying the deployment process.</p><p>To do this, you need to override the <code>$async</code> property in the action class:</p><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">DragonCode<span class="token punctuation">\</span>LaravelActions<span class="token punctuation">\</span>Action</span><span class="token punctuation">;</span>

<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token keyword">class</span> <span class="token class-name-definition class-name">extends</span> <span class="token class-name">Action</span>
<span class="token punctuation">{</span>
    <span class="token keyword">protected</span> <span class="token keyword type-declaration">bool</span> <span class="token variable">$async</span> <span class="token operator">=</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">void</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// some code</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>In this case, the action file that defines this parameter will run asynchronously using the <code>DragonCode\LaravelActions\Jobs\ActionJob</code> class.</p><p>The name of the connection and queue can be changed through the <a href="https://github.com/TheDragonCode/laravel-actions/tree/main/config" target="_blank" rel="noopener noreferrer">settings<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>.</p><p>::: Info We remind you that in this case the <a href="https://laravel.com/docs/queues" target="_blank" rel="noopener noreferrer">queuing system<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> must work in your application.</p><p>Using Laravel version 8.37 and above, checking for the <a href="https://laravel.com/docs/10.x/queues#unique-jobs" target="_blank" rel="noopener noreferrer">uniqueness<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> of the execution is supported. :::</p></div><!--[--><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="external-link meta-item-label" href="https://github.com/TheDragonCode/laravel-actions/edit/main/docs/how-to-use/running.md" rel="noopener noreferrer" target="_blank" aria-label="Edit this page"><!--[--><!--]--> Edit this page <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><!----></footer><nav class="page-nav"><p class="inner"><span class="prev"><a href="/how-to-use/rollback.html" class="" aria-label="Rolling Back Actions"><!--[--><!--]--> Rolling Back Actions <!--[--><!--]--></a></span><span class="next"><a href="/how-to-use/status.html" class="" aria-label="Actions Status"><!--[--><!--]--> Actions Status <!--[--><!--]--></a></span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/assets/app.b5592433.js" defer></script>
  </body>
</html>
